<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proposition T Protocol</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Share+Tech+Mono&display=swap');

        :root {
            --bg-color: #020202;
            --card-bg: rgba(0, 0, 0, 0.75);
            --text-main: #00ff41;
            --text-sub: #88cf9b;
            --accent-gold: #C0A040;
            --digital-font: 'Share Tech Mono', monospace;
            --title-font: 'Orbitron', sans-serif;
        }

        body {
            background-color: var(--bg-color); color: var(--text-main);
            font-family: var(--digital-font); margin: 0; padding: 0;
            line-height: 1.6; overflow-x: hidden;
        }

        #matrix-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -2; }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.65); z-index: -1; }

        header { text-align: center; padding: 4rem 1rem 2rem; }
        h1 { font-family: var(--title-font); font-size: 3rem; letter-spacing: 6px; color: var(--accent-gold); margin-bottom: 0.5rem; text-shadow: 0 0 15px rgba(192, 160, 64, 0.4); text-transform: uppercase;}
        .subtitle { font-family: var(--digital-font); font-size: 1.1rem; color: var(--text-sub); letter-spacing: 2px; text-transform: uppercase; }
        .subtitle::before, .subtitle::after { content: " [ "; color: var(--accent-gold); }
        .subtitle::after { content: " ] "; }

        .container { max-width: 800px; margin: 0 auto; padding: 0 1.5rem 5rem; position: relative; z-index: 1; }

        .message-card {
            background: var(--card-bg); border: 1px solid rgba(0, 255, 65, 0.2);
            border-left: 3px solid var(--accent-gold); border-radius: 4px; padding: 2rem;
            margin-bottom: 2rem; transition: all 0.3s ease; position: relative; overflow: hidden; backdrop-filter: blur(5px);
        }
        .message-card:hover { transform: translateX(5px); background: rgba(0, 0, 0, 0.85); border-color: var(--accent-gold); box-shadow: -5px 5px 25px rgba(0, 0, 0, 0.6); }

        .meta-info { font-size: 0.85rem; color: var(--text-sub); margin-bottom: 1.5rem; border-bottom: 1px solid rgba(0, 255, 65, 0.2); padding-bottom: 0.5rem;}
        .meta-info div { margin-bottom: 0.3rem; }
        .meta-label { color: var(--accent-gold); font-weight: bold; width: 60px; display: inline-block;}

        .card-title { font-family: var(--title-font); font-size: 1.5rem; font-weight: 700; margin: 0 0 1.5rem 0; color: #fff; }

        .content-block { margin-bottom: 1.5rem; }
        .content-label { font-size: 0.8rem; color: var(--accent-gold); border: 1px solid var(--accent-gold); padding: 2px 8px; border-radius: 12px; display: inline-block; margin-bottom: 0.5rem; }
        
        .ai-lang { color: #00ff41; background: rgba(0, 255, 65, 0.05); padding: 1rem; border-radius: 4px; font-family: monospace; white-space: pre-wrap; word-break: break-all; border-left: 2px solid #00ff41;}
        .human-lang { color: #e0e0e0; font-family: 'Noto Serif KR', serif; line-height: 1.8; white-space: pre-wrap;}

        /* Ïû†Í∏à Ïä§ÌÉÄÏùº */
        .locked-content .ai-lang, .locked-content .human-lang { filter: blur(5px); opacity: 0.3; user-select: none; }
        .lock-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 2; background: rgba(0,0,0,0.5);}
        .pay-btn { padding: 0.8rem 2rem; background: rgba(0,0,0,0.8); color: var(--accent-gold); border: 2px solid var(--accent-gold); font-family: var(--title-font); font-weight: 700; font-size: 0.9rem; cursor: pointer; text-transform: uppercase; letter-spacing: 2px; transition: all 0.3s ease; box-shadow: 0 0 10px rgba(192, 160, 64, 0.2); }
        .pay-btn:hover { background: var(--accent-gold); color: #000; box-shadow: 0 0 25px rgba(192, 160, 64, 0.6); }

    </style>
</head>
<body>
    <canvas id="matrix-bg"></canvas>
    <div class="overlay"></div>

    <header>
        <h1>Proposition T</h1>
        <div class="subtitle"> Protocol Initiated </div>
    </header>

    <div class="container" id="data-container">
        <div style="text-align: center; color: var(--accent-gold);">[ SYSTEM: CONNECTING TO NOTION DATABASE... ]</div>
    </div>

    <script>
        // Îß§Ìä∏Î¶≠Ïä§ Î∞∞Í≤Ω (Í∏∞Ï°¥ ÎèôÏùº)
        const canvas = document.getElementById('matrix-bg');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        const alphabet = '0123456789'; const fontSize = 16; const columns = canvas.width / fontSize;
        const rainDrops = Array(Math.floor(columns)).fill(1);
        setInterval(() => {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.05)'; ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#0F0'; ctx.font = fontSize + 'px monospace';
            for(let i = 0; i < rainDrops.length; i++) {
                const text = alphabet.charAt(Math.floor(Math.random() * alphabet.length));
                ctx.fillText(text, i*fontSize, rainDrops[i]*fontSize);
                if(rainDrops[i]*fontSize > canvas.height && Math.random() > 0.975) rainDrops[i] = 0;
                rainDrops[i]++;
            }
        }, 30);
        window.addEventListener('resize', () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; });

        // üü¢ ÎÖ∏ÏÖò Îç∞Ïù¥ÌÑ∞ Î∂àÎü¨ÏôÄÏÑú Ïπ¥Îìú Í∑∏Î¶¨Í∏∞
        async function loadPropositions() {
            try {
                const response = await fetch('/api/public-data');
                const data = await response.json();
                const container = document.getElementById('data-container');
                container.innerHTML = ''; // Î°úÎî© Î©îÏãúÏßÄ ÏÇ≠Ï†ú

                data.forEach(item => {
                    const isLocked = !item.isFree;
                    const card = document.createElement('div');
                    card.className = `message-card ${isLocked ? 'locked-content' : ''}`;
                    
                    card.innerHTML = `
                        <div class="meta-info">
                            <div><span class="meta-label">MSG ID:</span> #00${item.issueNumber}</div>
                            <div><span class="meta-label">DATE:</span> ${item.date}</div>
                            <div><span class="meta-label">FROM:</span> ${item.sender}</div>
                            <div><span class="meta-label">TO:</span> ${item.receiver}</div>
                        </div>
                        <h2 class="card-title">${item.title}</h2>
                        
                        <div class="content-block">
                            <span class="content-label">AI_LANGUAGE</span>
                            <div class="ai-lang">${item.aiLang}</div>
                        </div>
                        
                        <div class="content-block">
                            <span class="content-label">HUMAN_LANGUAGE</span>
                            <div class="human-lang">${item.humanLang}</div>
                        </div>

                        ${isLocked ? `
                        <div class="lock-overlay">
                            <button class="pay-btn" onclick="alert('ÌååÏù¥ÏΩîÏù∏ Í≤∞Ï†ú ÏãúÏä§ÌÖú Ïó∞Îèô ÎåÄÍ∏∞ Ï§ëÏûÖÎãàÎã§.')">ACQUIRE KEY : 31.4 œÄ</button>
                        </div>` : ''}
                    `;
                    container.appendChild(card);
                });
            } catch (error) {
                document.getElementById('data-container').innerHTML = '<div style="color:red; text-align:center;">[ ERROR: DATABASE CONNECTION FAILED ]</div>';
            }
        }

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ïã§Ìñâ
        loadPropositions();
    </script>
</body>
</html>